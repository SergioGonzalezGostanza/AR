<!-- <!DOCTYPE html>
<html lang="en">
<script
    src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
<script src="js/index.js"></script>

<style>
    .arjs-loader {
        height: 100%;
        width: 100%;
        position: absolute;
        top: 0;
        left: 0;
        background-color: rgba(0, 0, 0, 0.8);
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .arjs-loader div {
        text-align: center;
        font-size: 1.25em;
        color: white;
    }
</style>

<body style="margin : 0px; overflow: hidden;">
    
    <div class="arjs-loader">
        <div>Loading, please wait...</div>
    </div>
    <a-scene vr-mode-ui="enabled: false;" renderer="logarithmicDepthBuffer: true;" embedded
        arjs="trackingMethod: best; sourceType: webcam;debugUIEnabled: false;">
        we use cors proxy to avoid cross-origin problems ATTENTION! you need to set up your server
        <a-nft type="nft"
            url="your-server/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/trex-image/trex"
            smooth="true" smoothCount="10" smoothTolerance=".01" smoothThreshold="5">
            <a-entity
                gltf-model="your-server/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/scene.gltf"
                scale="5 5 5" position="50 150 0">
            </a-entity>
        </a-nft>
        <a-entity camera></a-entity>
    </a-scene>
</body>

</html> -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR-JS</title>
    <script src="https://aframe.io/releases/1.0.0/aframe.min.js"></script>
    <!-- <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script> -->
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.2/aframe/build/aframe-ar.js"></script>
    <script src="./target-marker.js"></script>
    <script>
        /* AFRAME.registerComponent('camera-logger', {
        
        schema: {
          timestamp: {type: 'int'},
          seconds: {type: 'int'} // default 0
        },
      
        log : function () {
          var cameraEl = this.el.sceneEl.camera.el;
          var rotation = cameraEl.getAttribute('rotation');
          var worldPos = new THREE.Vector3();
          worldPos.setFromMatrixPosition(cameraEl.object3D.matrixWorld);
          console.log("Time: " + this.data.seconds 
                      + "; Camera Position: (" + worldPos.x.toFixed(2) + ", " + worldPos.y.toFixed(2) + ", " + worldPos.z.toFixed(2) 
                      + "); Camera Rotation: (" + rotation.x.toFixed(2) + ", " + rotation.y.toFixed(2) + ", " + rotation.z.toFixed(2) + ")");        
        },
      
        play: function () {
          this.data.timestamp = Date.now();
          this.log();
        },
      
        tick: function () {  
          if (Date.now() - this.data.timestamp > 1000) {
            this.data.timestamp += 1000;
            this.data.seconds += 1;
            this.log();
          }
        },
      }); */
        /* AFRAME.registerComponent('rotation-reader', {
            //  We use IIFE (immediately-invoked function expression) to only allocate one
            //  vector or euler and not re-create on every tick to save memory.

            tick: (function () {
                var position = new THREE.Vector3();
                var quaternion = new THREE.Quaternion();

                return function () {
                    this.el.object3D.getWorldPosition(position);
                    this.el.object3D.getWorldQuaternion(quaternion);
                    // position and rotation now contain vector and quaternion in world space.
                    console.log(this.el.object3D.getWorldPosition(position));
                    console.log(this.el.object3D.getWorldQuaternion(quaternion));
                    alert(JSON.stringify(this.el.object3D.getWorldQuaternion(quaternion)));
                    alert(JSON.stringify(this.el.object3D.getWorldPosition(position)));
                };
            })()
        }); */

        /* function createBox() {
            AFRAME.registerComponent('box', {
                schema: {
                    width: { type: 'number', default: 1 },
                    height: { type: 'number', default: 1 },
                    depth: { type: 'number', default: 1 },
                    color: { type: 'color', default: '#AAA' }
                },

                // Initial creation and setting of the mesh.
                init: function () {
                    var data = this.data;
                    var el = this.el;

                    // Create geometry.
                    this.geometry = new THREE.BoxBufferGeometry(data.width, data.height, data.depth);

                    // Create material.
                    this.material = new THREE.MeshStandardMaterial({ color: data.color });

                    // Create mesh.
                    this.mesh = new THREE.Mesh(this.geometry, this.material);

                    // Set mesh on entity.
                    el.setObject3D('mesh', this.mesh);
                }
            });
        } */

        /* function asd() {
            var sceneEl = document.querySelector('a-scene');

            AFRAME.registerComponent('do-something-once-loaded', {
                init: function () {
                    // This will be called after the entity has properly attached and loaded.
                    console.log('I am ready!');
                },

                tick: function () {
                    // Don't call query selector in here, query beforehand.
                    for (let i = 0; i < this.entities.length; i++) {
                        // Do something with entities.
                        console.log(JSON.stringify(this.entities));
                    }
                }
            });

            var entityEl = document.createElement('a-entity');
            entityEl.setAttribute('dynamic-body', {
                shape: 'box',
                mass: 1.5,
                linearDamping: 0.005
            });
            sceneEl.appendChild(entityEl);
        } */

        function createFloor() {
            AFRAME.registerComponent('show-floor', {
                init: function () {
                    let scene = this.el;
                    
                    let newMark = document.createElement('a-plane')
                    /* newMark.setAttribute('geometry', {
                        primitive: 'plane'
                    }) */

                    // newMark.setAttribute('material', 'color: blue')
                    newMark.setAttribute('position', '0 0 -1.6')
                    newMark.setAttribute('rotation', '-60 0 0')
                    newMark.setAttribute('scale', '10 10 10')
                    newMark.setAttribute('normal-texture-repeat', '10 10')
                    newMark.setAttribute('normal-scale', '10 -10')
                    newMark.setAttribute('src', 'img/texture-florr.jpg')
                    newMark.setAttribute('normal-wrap', 'imgFloor')
                    newMark.setAttribute('opacity', '0.5')
                    scene.appendChild(newMark)
                },

                /* tick: function () {
                    // Don't call query selector in here, query beforehand.
                    for (let i = 0; i < this.entities.length; i++) {
                        // Do something with entities.
                    }
                } */
            });
        }

        if (window.DeviceOrientationEvent) {
            window.addEventListener("deviceorientation", function (event) {
                // alpha: rotation around z-axis
                var rotateDegrees = event.alpha;
                // gamma: left to right
                var leftToRight = event.gamma;
                // beta: front back motion
                var frontToBack = event.beta;

                if (frontToBack < 30 && frontToBack > 28) {
                    // setTimeout(() => {
                    /* document.getElementById('sphere').innerHTML = +
                        '<a-entity id="sphere" geometry="primitive: sphere" material="color: red; shader: flat" position="0 0.15 -5" light="type: point; intensity: 5" animation="property: position; easing: easeInOutQuad; dir: alternate; dur: 1000; to: 0 -0.10 -5; loop: true"></a-entity>' */
                    // }, 10000);
                    // createBox()
                    alert(frontToBack)
                }
            }, true);
        }


    </script>
</head>

<body>
    <a-scene cursor="rayOrigin: mouse" show-floor>
        <a-assets>
            <img id="imgFloor" src="img/texture-floor.jpg" alt="">
        </a-assets>
        <a-plane position="0 0 -1.6" rotation="-60 0 0" scale="10 10 10" normal-wrap="imgFloor"
            normal-texture-repeat="10 10" normal-scale="10 -10" src="img/texture-floor.jpg" opacity="0.5">
        </a-plane>
        <a-box position="0 .1 -1.5" rotation="0 0 0" scale=".1 .1 .1" material="color: red;" target-marker>
            <!-- 
            <a-animation attribute="rotation" dur="3000" to="360 360 0" repeat="indefinite" easing="linear">
            </a-animation> -->
        </a-box>
        <!-- <a-entity id="rig">
            
            <a-entity camera position="0 0 0" look-controls wasd-controls></a-entity>
            <a-cursor id="cursor" raycaster fuse="false" fusetimeout="3000"></a-cursor>
        </a-entity> -->
    </a-scene>
    <!-- <a-scene embedded arjs> -->
    <!-- <a-marker preset="hiro"> -->

    <!-- </a-marker> -->
    <!-- <a-entity camera look-controls rotation-reader></a-entity> -->
    <!-- <a-entity id="sphere" geometry="primitive: sphere" material="color: red; shader: flat" position="0 0.15 -5"
            light="type: point; intensity: 5"
            animation="property: position; easing: easeInOutQuad; dir: alternate; dur: 1000; to: 0 -0.10 -5; loop: true">
        </a-entity> -->
    <!-- </a-scene> -->

    <!-- <a-scene>
        <a-entity id="cameraWrapper" position="0 2 10" rotation="0 0 0">
            <a-camera listener id="camera">
                <a-box position="0 0.5 0" material="color: red;">
                    <a-animation attribute="rotation" dur="3000" to="360 360 0" repeat="indefinite" easing="linear">
                    </a-animation>
                </a-box>
            </a-camera>
        </a-entity>
        <a-plane position="0 4 4" rotation="-90 0 -90" width="4" height="4" color="#7BC8A4"></a-plane>
        <a-sky color="#ECECEC"></a-sky>
    </a-scene> -->
    <script src="js/index.js"></script>
</body>

</html>